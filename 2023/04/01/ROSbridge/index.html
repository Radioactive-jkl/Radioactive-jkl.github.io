


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  ROSbridge |    Radioactive</title>
  <meta name="description" content="A notebook, maybe.">
  <!-- 标签页图标 -->
  
  <link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet">
  <!-- 图标库 -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 动画库 -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fushaolei/cdn-white@1.0/css/animate.css"/>
  
  <!-- css文件 -->
  
<link rel="stylesheet" href="/css/white.css">

  <!-- 代码高亮 -->
  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.1/styles/github.css">

    
  
<meta name="generator" content="Hexo 5.4.2"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>


<body>

<div class="menu-outer">
    <div class="menu-inner">
      <div class="menu-site-name  animate__animated  animate__fadeInUp">
        <a href="/">
          Radioactive
        </a>
        
      </div>
      <div class="menu-group">
        <ul class="menu-ul">
        
          <a href="/" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              HOME
            </li>
          </a>
        
          <a href="/archives" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              BLOG
            </li>
          </a>
        
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="mobile-menu">
            <i class="ri-menu-line"></i>
          </li>
        
        </ul>

      </div>

    </div>
</div>
<div id="mobile-main" class="animate__animated  animate__fadeIn">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-site-name animate__animated  animate__fadeInUp">
      <a href="/">
        Radioactive
      </a>
    </div>
    <div class="mobile-menu-group" id="mobile-close">
      <i class="ri-close-line"></i>
    </div>

  </div>

  <div class="mobile-menu-div">
  
    <a href="/" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>HOME</span>
      </div>
    </a>
  
    <a href="/archives" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>BLOG</span>
      </div>
    </a>
  
  
  </div>


</div>

<div class="body-outer">
  <div class="body-inner">
    
<article class="post-inner">
  <div class="post-content-outer">
    <div class="post-intro">
      <div class="post-title animate__animated  animate__fadeInUp">ROSbridge</div>
      <div class="meta-intro animate__animated  animate__fadeInUp">Apr 01 2023</div>
      
    </div>
    <div class="post-content-inner">
      <div class="post-content-inner-space">

      </div>
      <div class="post-content-main animate__animated  animate__fadeInUp">
        <!-- top型目录 -->
        
        <p>ROS有很多开源的软件包、工具包，但是资料实在有限，只能自己摸索使用。最近有ROS与非ROS系统通信和ROS数据可视化的需求，于是用到了<strong>ROS bridge</strong>这一工具。以下是我对该工具的探索。<s>先写websocket，等有时间了再写TCP的。</s></p>
<h2 id="通信架构">通信架构</h2>
<p><s>以后完善博客再做图</s></p>
<ul>
<li><strong>服务端</strong>（一般是ROS端）通过rosbridge_server运行已架设好的完整服务器</li>
<li><strong>客户端</strong>（一般是电脑）通过roslib的API编写相应<u>非ROS程序</u>实现与服务器的连接和交互</li>
</ul>
<h2 id="文件结构">文件结构</h2>
<p><s>under construction</s></p>
<p>服务端</p>
<pre><code>rosbridge
  rosbridge_server
    rosbridge_websocket
    ...
    rosbridge_tcp
    ...
    rosbridge_udp
    ...
    
  ...
  
</code></pre>
<p>客户端</p>
<pre><code>roslibjs
  ...
  
</code></pre>
<h2 id="roslibjs与websocket">roslibjs与websocket</h2>
<h3 id="服务端">服务端</h3>
<p>首先肯定是启动各节点，让各Topic跑起来，以及：</p>
<pre><code>roslaunch rosbridge_server rosbridge_websocket
</code></pre>
<p>获取IP与端口号，默认是<code>ws://0.0.0.0:9090</code> ，若客户端不在本机上就要使用其IPv4:</p>
<pre><code>ifconfig
</code></pre>
<h3 id="客户端">客户端</h3>
<p>先下载<code>roslibjs</code>，解压后文件夹内打开终端：</p>
<pre><code>npm install

一般会报错，按提示输指令修复。

没有科学上网的话修复也会错，可以用国内淘宝的：
cnpm install
以及 修复指令

</code></pre>
<p>然后在example文件夹里放自己的<code>.html</code>文件即可，下面给出我自己的IMU输出客户端代码：</p>
<ul>
<li><code>imu.html</code></li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;title&gt;Document&lt;/title&gt;
  &lt;script src=&quot;https://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;../build/roslib.js&quot;&gt;&lt;/script&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;imu.css&quot;&gt;
  &lt;script&gt;
  // Connecting to ROS
  
  var ros = new ROSLIB.Ros();


  // If there is an error on the backend, an 'error' emit will be emitted.
  
  ros.on('error', function(error) &#123;
    document.getElementById('connecting').style.display = 'none';
    document.getElementById('connected').style.display = 'none';
    document.getElementById('closed').style.display = 'none';
    document.getElementById('error').style.display = 'inline';
    console.log(error);
  &#125;);


  // Find out exactly when we made a connection.
  
  ros.on('connection', function() &#123;
    console.log('Connection made!');
    document.getElementById('connecting').style.display = 'none';
    document.getElementById('error').style.display = 'none';
    document.getElementById('closed').style.display = 'none';
    document.getElementById('connected').style.display = 'inline';
  &#125;);

  ros.on('close', function() &#123;
    console.log('Connection closed.');
    document.getElementById('connecting').style.display = 'none';
    document.getElementById('connected').style.display = 'none';
    document.getElementById('closed').style.display = 'inline';
  &#125;);


  // Create a connection to the rosbridge WebSocket server.
  
  // Put your own IP here.
  ros.connect('ws://xxx.xxx.xxx.xx:9090');


  //Subscribing to a Topic, use 'rostopic' to confirm your information below.
  
  var listener = new ROSLIB.Topic(&#123;
    ros : ros,
    name : '/raw_imu',
    messageType : 'sensor_msgs/Imu'
  &#125;);


  // Then we add a callback to be called every time a message is published on this topic.
  
  listener.subscribe(function(message) &#123;
  
    console.log('Received message on ' + listener.name + ': ' + message.angular_velocity.x +', '+ message.angular_velocity.y+': '+message.angular_velocity.z);
    
    var Msg=document.getElementById(&quot;message&quot;);
    Msg.innerHTML='Received message on ' + listener.name + ': ' + message.angular_velocity.x +', '+ message.angular_velocity.y+': '+message.angular_velocity.z;
    
    // If desired, we can unsubscribe from the topic as well.
    //listener.unsubscribe();
    
  &#125;);

 
&lt;/script&gt;
&lt;/head&gt;
 
&lt;body&gt;
  &lt;h1&gt;Simple roslib Example by Radioactive&lt;/h1&gt;
  &lt;p&gt;Open your own nodes.&lt;/p&gt;
  Run the following commands in the terminal then refresh this page. Check the JavaScript
  &lt;p&gt;console for the output.&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;&lt;tt&gt;roslaunch rosbridge_server rosbridge_websocket&lt;/tt&gt;&lt;/li&gt;
    &lt;li&gt;&lt;tt&gt;&lt;/tt&gt;&lt;/li&gt;
  &lt;/ol&gt;
  &lt;div id=&quot;statusIndicator&quot;&gt;
    &lt;p id=&quot;connecting&quot;&gt;
      Connecting to rosbridge...
    &lt;/p&gt;
    &lt;p id=&quot;connected&quot;&gt;
      Connected
    &lt;/p&gt;
    &lt;p id=&quot;error&quot; &gt;
      Error in the backend!
    &lt;/p&gt;
    &lt;p id=&quot;closed&quot;&gt;
      Connection closed.
    &lt;/p&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;h2&gt;Car message&lt;/h2&gt;
    &lt;p id=&quot;message&quot;&gt;&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<ul>
<li><code>imu.css</code></li>
</ul>
<pre><code>#connected&#123;
    color:#00D600; 
    display:none;
&#125;
#error&#123;
    color:#FF0000; 
    display:none;
&#125;
#closed&#123;
    display: none;
&#125;
li&#123;
    list-style: none;
&#125;
#message&#123;
    padding: 10px;
&#125;

</code></pre>
<h2 id="roslibpy与tcpsocket">roslibpy与TCPsocket</h2>
<p><s>UNDER CONSTRUCTION</s></p>

        <!-- 分类文章 -->
        
      </div>
      <div class="post-content-inner-space">
        
          <div class="space-toc-main animate__animated  animate__fadeInUp">
            <ol class="space-toc"><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9E%B6%E6%9E%84"><span class="space-toc-text">通信架构</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="space-toc-text">文件结构</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#roslibjs%E4%B8%8Ewebsocket"><span class="space-toc-text">roslibjs与websocket</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#roslibpy%E4%B8%8Etcpsocket"><span class="space-toc-text">roslibpy与TCPsocket</span></a></li></ol>
           </div>
        
      </div>
   </div>
    <!-- 评论 -->
    
  </div>
</article>
  </div>
</div>



<!-- 如果是home模式的话，不在首页就显示footer，如果不是home模式的话 所有都显示footer -->

  <div class="footer-outer animate__animated  animate__fadeInUp">
    <div class="footer-inner">
    <div class="footer-text">
    <p>Radioactive | Power by <a target="_blank" rel="noopener" href="http://hexo.io/">Hexo</a></p>

    </div>
    <div class="footer-contact">
    <ul class="footer-ul">
        
    </ul>
    </div>
    </div>
</div>






<script src="/js/white.js"></script>



    
      
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

      <script>hljs.initHighlightingOnLoad();</script>
    

</body>
</html>
